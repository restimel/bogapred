!function t(e,o,n){function r(i,c){if(!o[i]){if(!e[i]){var a="function"==typeof require&&require;if(!c&&a)return a(i,!0);if(s)return s(i,!0);var d=new Error("Cannot find module '"+i+"'");throw d.code="MODULE_NOT_FOUND",d}var u=o[i]={exports:{}};e[i][0].call(u.exports,function(t){var o=e[i][1][t];return r(o?o:t)},u,u.exports,t,e,o,n)}return o[i].exports}for(var s="function"==typeof require&&require,i=0;i<n.length;i++)r(n[i]);return r}({1:[function(t,e,o){function n(t){var e;this.callbacks=t,"undefined"==typeof self.indexedDB?(this.db=!1,n.error("The browser does not seem to support indexedDB"),this.loadData()):(e=self.indexedDB.open(s,r),e.onerror=this.onOpenError.bind(this),e.onupgradeneeded=this.onupgradeneeded.bind(this),e.onsuccess=this.onConnection.bind(this),e.onblocked=this.onupgradeneeded.bind(this))}var r=1,s="bogapred";n.prototype.onBlocked=function(t){sendMessage($$("This application is running in another context. Its version is deprecated and must be refresh."),"info",{time:7e3,html:!1})},n.prototype.onOpenError=function(t){n.error("error while opening DB"),this.db=!1,this.loadData()},n.prototype.onupgradeneeded=function(t){this.db=t.target.result;var e;switch(t.oldVersion){case 0:e=this.db.createObjectStore("projects"),e.createIndex("name","name",{unique:!0}),e=this.db.createObjectStore("logs",{keyPath:"history",autoIncrement:!0}),e=this.db.createObjectStore("context"),e.createIndex("key","key",{unique:!0})}},n.prototype.onVersionChange=function(t){console.warn("indexedDB version has changed in a newer context. This page should be reloaded."),this.db.close(),this.db=!1},n.prototype.onConnection=function(t){this.db?this.loadData():this.db=t.target.result,this.db.onversionchange=this.onVersionChange.bind(this),this.loadToStore(this.callbacks)},n.prototype.loadProjects=function(){console.info("loadProjects has not been defined")},n.prototype.loadToStore=function(t){function e(e){e&&(e.length?e.forEach(function(e){t.saveProject(e,{fromDB:!0})}):this.loadProjects())}this.getProjects(e.bind(this)),this.loadContexts(t)},n.prototype.getProject=function(t,e){if(this.db){var o=this.db.transaction(["projects"],"readonly").objectStore("projects").index("name").get(t);o.onsuccess=function(t){e(t.target.result)}}else e(null)},n.prototype.getProjects=function(t){function e(e){var n=e.target.result;n?(o.push(n.value),n["continue"]()):t(o)}var o=[];if(this.db){var n=this.db.transaction(["projects"],"readonly").objectStore("projects").index("name").openCursor();n.onsuccess=e}else t(null)},n.prototype.setProject=function(t){var e,o;this.db&&(e=t.name,o=this.db.transaction(["projects"],"readwrite"),o.objectStore("projects").put(t,e))},n.prototype.removeCube=function(t,e){var o,n,r;this.db?(o=t,n=this.db.transaction(["projects"],"readwrite"),r=n.objectStore("projects")["delete"](o),r.onsuccess=e,r.onerror=e):e(null)},n.prototype.getContext=function(t,e){if(this.db){var o=this.db.transaction(["context"],"readonly").objectStore("context").index("key").get(t);o.onsuccess=function(t){e(t.target.result.value)}}else n.error('Could not get context "'+t+'"'),e(null)},n.prototype.loadContexts=function(t){function e(e){var o=e.target.result;o?(n[o.key]=o.value,o["continue"]()):t.storeContext(n)}var o,n={};this.db&&(o=this.db.transaction(["context"],"readonly").objectStore("context").index("key").openCursor(),o.onsuccess=e)},n.prototype.setContext=function(t,e){var o,n,r;this.db&&(o=t,n={key:o,value:e},r=this.db.transaction(["context"],"readwrite"),r.objectStore("context").put(n,o))},n.prototype.incContext=function(t){this.db&&this.getContext(t,function(t,e){this.setContext(t,e+1)}.bind(this,t))},n.prototype.addLog=function(){},n.error=function(t){return function(e){console.error(t,e)}},e.exports=n},{}],2:[function(t,e,o){var n=t("storage/indexDB"),r={db:new n({saveProject:function(t){r.projects.push(projects)},storeContext:function(t){r.context=t}}),projects:[],project:null,context:{},save:function(){this.db.setProject(this.project)},loadProject:function(t){this.db.getProject(t,function(t){r.project=t})},getProjects:function(){}};e.exports=r},{"storage/indexDB":1}],3:[function(t,e,o){"undefined"!=typeof console&&console.log("worker started");t("storage/store")},{"storage/store":2}]},{},[3]);